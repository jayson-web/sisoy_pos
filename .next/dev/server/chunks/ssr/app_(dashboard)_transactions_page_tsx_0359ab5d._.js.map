{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jayso/pos_sisoy/app/%28dashboard%29/transactions/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { getApiBase } from \"@/lib/api\"\r\n\r\ninterface Transaction {\r\n  id: number\r\n  booking_id: number\r\n  customer_id: number\r\n  amount: number\r\n  payment_method: string\r\n  status: string\r\n  transaction_reference: string\r\n  description: string\r\n  created_at: string\r\n}\r\n\r\nexport default function TransactionsPage() {\r\n  const [transactions, setTransactions] = useState<Transaction[]>([])\r\n  const [loading, setLoading] = useState(false)\r\n  const [editingId, setEditingId] = useState<number | null>(null)\r\n  const [editData, setEditData] = useState<Partial<Transaction>>({})\r\n\r\n  // Load transactions on mount\r\n  useEffect(() => {\r\n    loadTransactions()\r\n  }, [])\r\n\r\n  const loadTransactions = async () => {\r\n    setLoading(true)\r\n    const apiBase = getApiBase()\r\n    try {\r\n      const resp = await fetch(`${apiBase}/transactions?action=list`)\r\n      if (resp.ok) {\r\n        const data = await resp.json()\r\n        setTransactions(data.data || [])\r\n      } else {\r\n        console.error(\"Failed to load transactions\")\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error loading transactions:\", error)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleDelete = async (id: number) => {\r\n    if (!confirm(\"Delete this transaction? This cannot be undone.\")) return\r\n\r\n    const apiBase = getApiBase()\r\n    try {\r\n      const resp = await fetch(`${apiBase}/transactions?id=${id}`, {\r\n        method: \"DELETE\",\r\n      })\r\n      if (resp.ok) {\r\n        setTransactions(transactions.filter((t) => t.id !== id))\r\n        alert(\"Transaction deleted successfully\")\r\n      } else {\r\n        alert(\"Failed to delete transaction\")\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error deleting transaction:\", error)\r\n      alert(\"Error deleting transaction\")\r\n    }\r\n  }\r\n\r\n  const handleEditStart = (transaction: Transaction) => {\r\n    setEditingId(transaction.id)\r\n    setEditData(transaction)\r\n  }\r\n\r\n  const handleEditCancel = () => {\r\n    setEditingId(null)\r\n    setEditData({})\r\n  }\r\n\r\n  const handleEditSave = async (id: number) => {\r\n    const apiBase = getApiBase()\r\n    try {\r\n      const resp = await fetch(`${apiBase}/transactions?id=${id}`, {\r\n        method: \"PATCH\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(editData),\r\n      })\r\n      if (resp.ok) {\r\n        const updated = await resp.json()\r\n        setTransactions(\r\n          transactions.map((t) => (t.id === id ? { ...t, ...updated } : t))\r\n        )\r\n        setEditingId(null)\r\n        setEditData({})\r\n        alert(\"Transaction updated successfully\")\r\n      } else {\r\n        alert(\"Failed to update transaction\")\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error updating transaction:\", error)\r\n      alert(\"Error updating transaction\")\r\n    }\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"text-center py-12\">\r\n        <p>Loading transactions...</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div>\r\n        <h1 className=\"text-3xl font-bold text-(--primary-blue)\">Transactions</h1>\r\n        <p className=\"text-(--gray-dark) mt-2\">Manage all payment transactions</p>\r\n      </div>\r\n\r\n      {/* Transactions Table */}\r\n      <div className=\"bg-white border border-(--gray-light) rounded overflow-x-auto\">\r\n        <table className=\"w-full\">\r\n          <thead className=\"bg-(--gray-bg) border-b border-(--gray-light)\">\r\n            <tr>\r\n              <th className=\"text-left py-3 px-4 font-bold text-(--gray-dark)\">ID</th>\r\n              <th className=\"text-left py-3 px-4 font-bold text-(--gray-dark)\">Booking ID</th>\r\n              <th className=\"text-left py-3 px-4 font-bold text-(--gray-dark)\">Customer ID</th>\r\n              <th className=\"text-left py-3 px-4 font-bold text-(--gray-dark)\">Amount</th>\r\n              <th className=\"text-left py-3 px-4 font-bold text-(--gray-dark)\">Payment Method</th>\r\n              <th className=\"text-left py-3 px-4 font-bold text-(--gray-dark)\">Status</th>\r\n              <th className=\"text-left py-3 px-4 font-bold text-(--gray-dark)\">Reference</th>\r\n              <th className=\"text-left py-3 px-4 font-bold text-(--gray-dark)\">Date</th>\r\n              <th className=\"text-left py-3 px-4 font-bold text-(--gray-dark)\">Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {transactions.map((txn) => (\r\n              <tr key={txn.id} className=\"border-b border-(--gray-light) hover:bg-(--gray-bg)\">\r\n                <td className=\"py-3 px-4 text-sm font-mono\">{txn.id}</td>\r\n                <td className=\"py-3 px-4 text-sm\">{txn.booking_id}</td>\r\n                <td className=\"py-3 px-4 text-sm\">{txn.customer_id}</td>\r\n                <td className=\"py-3 px-4 text-sm font-bold\">\r\n                  {editingId === txn.id ? (\r\n                    <input\r\n                      type=\"number\"\r\n                      step=\"0.01\"\r\n                      value={editData.amount || txn.amount}\r\n                      onChange={(e) =>\r\n                        setEditData({\r\n                          ...editData,\r\n                          amount: parseFloat(e.target.value),\r\n                        })\r\n                      }\r\n                      className=\"w-24 px-2 py-1 border border-gray-300 rounded\"\r\n                    />\r\n                  ) : (\r\n                    `â‚±${txn.amount.toLocaleString()}`\r\n                  )}\r\n                </td>\r\n                <td className=\"py-3 px-4 text-sm\">\r\n                  {editingId === txn.id ? (\r\n                    <input\r\n                      type=\"text\"\r\n                      value={editData.payment_method || txn.payment_method}\r\n                      onChange={(e) =>\r\n                        setEditData({\r\n                          ...editData,\r\n                          payment_method: e.target.value,\r\n                        })\r\n                      }\r\n                      className=\"w-32 px-2 py-1 border border-gray-300 rounded\"\r\n                    />\r\n                  ) : (\r\n                    txn.payment_method\r\n                  )}\r\n                </td>\r\n                <td className=\"py-3 px-4 text-sm\">\r\n                  {editingId === txn.id ? (\r\n                    <select\r\n                      value={editData.status || txn.status}\r\n                      onChange={(e) =>\r\n                        setEditData({\r\n                          ...editData,\r\n                          status: e.target.value,\r\n                        })\r\n                      }\r\n                      className=\"px-2 py-1 border border-gray-300 rounded\"\r\n                    >\r\n                      <option>completed</option>\r\n                      <option>pending</option>\r\n                      <option>failed</option>\r\n                      <option>refunded</option>\r\n                    </select>\r\n                  ) : (\r\n                    <span\r\n                      className={`px-2 py-1 rounded text-xs font-bold ${\r\n                        txn.status === \"completed\"\r\n                          ? \"bg-green-100 text-green\"\r\n                          : txn.status === \"pending\"\r\n                          ? \"bg-yellow-100 text-yellow-800\"\r\n                          : txn.status === \"failed\"\r\n                          ? \"bg-red-100 text-red\"\r\n                          : \"bg-gray-100 text-gray-800\"\r\n                      }`}\r\n                    >\r\n                      {txn.status}\r\n                    </span>\r\n                  )}\r\n                </td>\r\n                <td className=\"py-3 px-4 text-sm font-mono text-xs\">\r\n                  {txn.transaction_reference}\r\n                </td>\r\n                <td className=\"py-3 px-4 text-sm text-(--gray-dark)\">\r\n                  {new Date(txn.created_at).toLocaleDateString()}\r\n                </td>\r\n                <td className=\"py-3 px-4 text-sm space-x-2\">\r\n                  {editingId === txn.id ? (\r\n                    <>\r\n                      <button\r\n                        onClick={() => handleEditSave(txn.id)}\r\n                        className=\"text-green hover:underline font-bold\"\r\n                      >\r\n                        Save\r\n                      </button>\r\n                      <button\r\n                        onClick={handleEditCancel}\r\n                        className=\"text-gray-500 hover:underline\"\r\n                      >\r\n                        Cancel\r\n                      </button>\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <button\r\n                        onClick={() => handleEditStart(txn)}\r\n                        className=\"text-(--primary-blue) hover:underline\"\r\n                      >\r\n                        Edit\r\n                      </button>\r\n                      <button\r\n                        onClick={() => handleDelete(txn.id)}\r\n                        className=\"text-red hover:underline\"\r\n                      >\r\n                        Delete\r\n                      </button>\r\n                    </>\r\n                  )}\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {transactions.length === 0 && (\r\n        <div className=\"text-center py-12 bg-(--gray-bg) rounded\">\r\n          <p className=\"text-(--gray-dark)\">No transactions found.</p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}